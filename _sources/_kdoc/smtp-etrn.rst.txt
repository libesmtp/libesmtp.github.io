**RFC 1985**


Remote Message Queue Starting (ETRN)
------------------------------------

The SMTP ETRN extension is used to request a remote MTA to start its
delivery queue for the specified domain.  If the application requests
the use if the ETRN extension and the remote MTA does not list ETRN,
libESMTP will use the event callback to notify the application.

.. c:function:: smtp_etrn_node_t smtp_etrn_add_node (smtp_session_t session, int option, const char * domain)


**Parameters**

``smtp_session_t session``
  The session.

``int option``
  The option character.

``const char * domain``
  Request mail for this domain.

**Description**

Add an ETRN node to the SMTP session.

**Return**

An :c:type:`typedef smtp_etrn_node_t <smtp_etrn_node_t>` or ``NULL`` on failure.


.. c:function:: int smtp_etrn_enumerate_nodes (smtp_session_t session, smtp_etrn_enumerate_nodecb_t cb, void * arg)


**Parameters**

``smtp_session_t session``
  The session.

``smtp_etrn_enumerate_nodecb_t cb``
  Callback function

``void * arg``
  Argument (closure) passed to callback.

**Description**

Call the callback function once for each ETRN node in the SMTP session.

**Return**

Zero on failure, non-zero on success.


.. c:function:: const smtp_status_t * smtp_etrn_node_status (smtp_etrn_node_t node)


**Parameters**

``smtp_etrn_node_t node``
  An #smtp_etrn_node_t

**Description**

Retrieve the ETRN node success/failure status from a previous SMTP session.
This includes SMTP status codes, RFC 2034 enhanced status codes, if
available and text from the server describing the status.

**Return**

``NULL`` if no status information is available,
otherwise a pointer to the status information.  The pointer remains valid
until the next call to libESMTP in the same thread.


.. c:function:: void * smtp_etrn_set_application_data (smtp_etrn_node_t node, void * data)


**Parameters**

``smtp_etrn_node_t node``
  An #smtp_etrn_node_t

``void * data``
  Application data to set

**Description**

Associate application defined data with the opaque ETRN structure.

**Return**

Previously set application data or ``NULL``.


.. c:function:: void * smtp_etrn_get_application_data (smtp_etrn_node_t node)


**Parameters**

``smtp_etrn_node_t node``
  An #smtp_etrn_node_t

**Description**

Retrieve application data from the opaque ETRN structure.

**Return**

Application data or ``NULL``.


